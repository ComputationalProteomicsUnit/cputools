<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Standardising R package development • cputools</title>
<!-- jquery --><script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script><!-- Font Awesome icons --><link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">
<!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../jquery.sticky-kit.min.js"></script><script src="../pkgdown.js"></script><!-- mathjax --><script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-vignette">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="../index.html">cputools</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../articles/index.html">Articles</a>
</li>
<li>
  <a href="../news/index.html">News</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/ComputationalProteomicsUnit/cputools">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9">
    <div class="page-header toc-ignore">
      <h1>Standardising R package development</h1>
                        <h4 class="author">Laurent Gatto</h4>
            <address class="author_afil">
      Computational Proteomics Unit, Cambridge, UK<br>
</address>
</div>

    
        <div class="abstract">
      <p class="abstract">Abstract</p>
      <p>The <em><a href="https://github.com/ComputationalProteomicsUnit/cputools">cputools</a></em> package provides a set of helper functions and guidelines to streamline and standardise package development and data analysis reporting for the <a href="http://cpu.sysbiol.cam.ac.uk/">Computational Proteomics Unit</a> group.</p>
    </div>
    
<div class="contents">
<blockquote>
<p>This is work in progress.</p>
</blockquote>
<div id="introduction" class="section level1">
<h1 class="hasAnchor">
<html><body><a href="#introduction" class="anchor"> </a></body></html>Introduction</h1>
<p>This vignette summarises some <em>good practice</em> for R programming and package development. I tend to follow these myself and advise my collaborators to use them when we work on projects together.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(<span class="st">"cputools"</span>)</code></pre>
<p>See also the <a href="https://github.com/ComputationalProteomicsUnit/cputools/wiki">CPU wiki</a> for a non-exhaustive list.</p>
<div id="github-user" class="section level2">
<h2 class="hasAnchor">
<html><body><a href="#github-user" class="anchor"> </a></body></html>GitHub user</h2>
<p>Several function in the <code>cputools</code> package require a GitHub user name to generate correct links to the software’s page using <code>makeGithubUrl</code>, for example. The user name, when not provided explicitly, is fetched from the session options with <code>options("GitHubUserName")</code>, which can be set in your <code>.Rprofile</code> using</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">options</span>(<span class="dt">GitHubUserName =</span> <span class="st">"ComputationalProteomicsUnit"</span>)</code></pre>
<p>If set, one can just call this function above with</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/makeGithubUrl.html">makeGithubUrl</a></span>(<span class="st">"cputools"</span>)</code></pre>
<p>Otherwise, the user can be specified explicitly with</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/makeGithubUrl.html">makeGithubUrl</a></span>(<span class="st">"cputools"</span>, <span class="dt">user =</span> <span class="st">"ComputationalProteomicsUnit"</span>)</code></pre>
</div>
</div>
<div id="credibility" class="section level1">
<h1 class="hasAnchor">
<html><body><a href="#credibility" class="anchor"> </a></body></html>Credibility</h1>
<p>Demonstrate good programming skills by writing clean and maintainable code, provide good documentation and follow good community practice. I would recommend to follow the <a href="https://bioconductor.org/developers/package-guidelines/">Bioconductor guidelines</a> for package development and submission, in particular good documentation, vignettes and unit testing. I would also add continous integration (see below) to this.</p>
<p>An essential aspect is to officially release the package. This can be done by submitting it to a public package repository such as CRAN or Biocondcutor. For any package related to high throughput biology, acceptance to Bioconductor is becoming, in my opinion, a requirement. It doesn’t mean that there aren’t any good biology-related packages that are not in Bioconductor, or that all packages in Bioconductor are first class packages, but any serious package developer should ideally develope a package that matches Bioconductor standards and review. A package that is only available on a personal web page might not be reagarded positively in a first instance; a package that has passed a well defined and formal review process (and has been looked at by an experience R developer, which is probably more that most of the bioinformatics tools available out there), shows that the authors cared enough about his work to polish it to Bioconductor standards.</p>
<p>If the package is not to be submitted to Bioconductor (in particular if it doesn’t fall into the project’s remit), then the developer should implement their own continous integration system (see below) to demonstrate that the package successfully builds/checks on a third-party infrastructure, ideally on different systems.</p>
</div>
<div id="description" class="section level1">
<h1 class="hasAnchor">
<html><body><a href="#description" class="anchor"> </a></body></html>DESCRIPTION</h1>
<blockquote>
<p>Use <code>Authors@R</code> to define authors and their respective roles.</p>
</blockquote>
<p>This is a requirement to generate package webpages with <em><a href="https://github.com/pkgdown">pkgdown</a></em> later on.</p>
</div>
<div id="readme-files" class="section level1">
<h1 class="hasAnchor">
<html><body><a href="#readme-files" class="anchor"> </a></body></html>README files</h1>
<p><code>README</code> files are important for any software project, as they provide an obvious first entry point to read more about the package. On github, using markdown makes them visually appealing. Using R markdown enables to include dynamically generated content. Finally, as we will see below, they can be used to easily produce a compelling and useful webpage for the R package.</p>
<blockquote>
<p>Create a <code>README.Rmd</code> file.</p>
</blockquote>
<p>The default pipeline will this be to <em>knit</em> the <code>REAMDE.Rmd</code> file to <code>READEM.md</code> using the <code>knitr::knit</code> function. To avoid the two file to come out of sync when forgetting to <code>knit</code>. To avoid this, one can set up a git hook, more specifically a <code>pre-commit</code> hook, that will check that the <code>Rmd</code> file is not more recent than the <code>md</code> file.</p>
<p>The simplest is to use <code>devtools::use_readme_rmd()</code> to create the <code>README.Rmd</code> template (see <a href="http://r-pkgs.had.co.nz/release.html#important-files"><em>Important files</em></a>) in the <em>Advanced R</em> book. This pre-commit hook <code>./.git/hooks/pre-commit</code> will contain</p>
<pre class="sh"><code>#!/bin/bash
README=($(git diff --cached --name-only | grep -Ei '^README\.[R]?md$'))
MSG="use 'git commit --no-verify' to override this check"

if [[ ${#README[@]} == 0 ]]; then
  exit 0
fi

if [[ README.Rmd -nt README.md ]]; then
  echo -e "README.md is out of date; please re-knit README.Rmd\n$MSG"
  exit 1
elif [[ ${#README[@]} -lt 2 ]]; then
  echo -e "README.Rmd and README.md should be both staged\n$MSG"
  exit 1
fi</code></pre>
<p>To create the hook if you already have a <code>README.Rmd</code> file, use <code>devtools::use_git_hook</code>:</p>
<pre class="sourceCode r"><code class="sourceCode r">devtools::<span class="kw">use_git_hook</span>(<span class="st">"pre-commit"</span>, devtools:::<span class="kw">render_template</span>(<span class="st">"readme-rmd-pre-commit.sh"</span>))</code></pre>
<p>See <code>?use_git_hook</code> for details.</p>
<blockquote>
<p>Add a <code>pre-commit hook</code></p>
</blockquote>
</div>
<div id="code-versioning-dissemination-and-issues" class="section level1">
<h1 class="hasAnchor">
<html><body><a href="#code-versioning-dissemination-and-issues" class="anchor"> </a></body></html>Code versioning, dissemination and issues</h1>
</div>
<div id="continous-integration" class="section level1">
<h1 class="hasAnchor">
<html><body><a href="#continous-integration" class="anchor"> </a></body></html>Continous integration</h1>
<ul>
<li>Suggest travis. Explain how to set up.</li>
<li><p>If want to use another system, please document it here.</p></li>
<li><p>Biocondcutor packages are testing on all platforms. Not necessary to have additional third-pary CI.</p></li>
</ul>
</div>
<div id="adding-status" class="section level1">
<h1 class="hasAnchor">
<html><body><a href="#adding-status" class="anchor"> </a></body></html>Adding status</h1>
<p>Status shields provide quick visual information regarding the build/check status of your package and it’s testing coverage.</p>
<div id="bioconductor-shields" class="section level2">
<h2 class="hasAnchor">
<html><body><a href="#bioconductor-shields" class="anchor"> </a></body></html>Bioconductor shields</h2>
<p>If the package is on Biocondcutor, then the build/check status and testing coverage will be provided by them and the shields can be directly generated with the <code>makeBiocBuildShield</code> and <code>makeBiocCovrShield</code>. Below is an example for the <code>hpar</code> package.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/makeTravisShield.html">makeBiocBuildShield</a></span>(<span class="st">"hpar"</span>)</code></pre>
<p><a href="http://bioconductor.org/packages/devel/bioc/html/hpar.html"><img src="http://bioconductor.org/shields/build/devel/bioc/hpar.svg" alt="Bioconductor devel build status"></a></p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/makeTravisShield.html">makeBiocCovrShield</a></span>(<span class="st">"hpar"</span>)</code></pre>
<p><a href="https://codecov.io/github/Bioconductor-mirror/hpar/branch/master"><img src="https://bioconductor.org/shields/coverage/devel/hpar.svg" alt="Bioconductor devel build status"></a></p>
<p>By default, the shields for the devel branch are produced. Use <code>branch = "release"</code> to use the release branch.</p>
<blockquote>
<p>If your package is on Bioconductor, display the build and coverage shields.</p>
</blockquote>
</div>
<div id="travis-shield" class="section level2">
<h2 class="hasAnchor">
<html><body><a href="#travis-shield" class="anchor"> </a></body></html>Travis shield</h2>
<p>If the package is not on Bioconductor, you’ll have to set up a continuous integration server that automatically builds and checks your package. I recommend <a href="https://travis-ci.org/">travis-ci</a> for linux (and OSX, although I haven’t successfully used that myself) and appveyor for windows to build/check the package and <em><a href="http://cran.fhcrc.org/web/packages/covr/index.html">covr</a></em> and <a href="https://codecov.io/">codecov</a> for test coverage.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/makeTravisShield.html">makeTravisShield</a></span>(<span class="st">"cputools"</span>, <span class="dt">user =</span> <span class="st">"ComputationalProteomicsUnit"</span>)</code></pre>
<p><a href="https://travis-ci.org/ComputationalProteomicsUnit/cputools"><img src="https://travis-ci.org/ComputationalProteomicsUnit/cputools.svg?branch=master" alt="Build Status"></a></p>
<blockquote>
<p>Add a travis build/check shield, unless there’s already a Bioconductor shield.</p>
</blockquote>
<p>Note: I haven’t looked up how to automatically generate the code for a codecov shield yet, so that one will have to be cut and pasted manually.</p>
</div>
<div id="bioc-andor-travis" class="section level2">
<h2 class="hasAnchor">
<html><body><a href="#bioc-andor-travis" class="anchor"> </a></body></html>Bioc and/or travis</h2>
</div>
</div>
<div id="asking-for-help" class="section level1">
<h1 class="hasAnchor">
<html><body><a href="#asking-for-help" class="anchor"> </a></body></html>Asking for help</h1>
<p>It is important to provide a venue for users to ask for help and report bugs. I tend to use two channels for that, namely GitHub issues and, for Bioconductor package, the Bioconductor support site. The <code>pkgqsts</code> function will create a default section (level 2 below, default is 1):</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/makeGithubUrl.html">pkgqsts</a></span>(<span class="st">"cputools"</span>, <span class="dt">level =</span> 2L, <span class="dt">user =</span> <span class="st">"ComputationalProteomicsUnit"</span>)</code></pre>
<pre><code>## ## Questions and support
## To get help:
##  - Open a GitHub [issue](https://github.com/ComputationalProteomicsUnit/cputools/issues)
##  - Post your question on the [Bioconductor support site](https://support.bioconductor.org/)</code></pre>
<p>As this package is not on Bioconductor, the Bioconductor support site is disables with <code>bioc = FALSE</code> and rendered as shown below.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/makeGithubUrl.html">pkgqsts</a></span>(<span class="st">"cputools"</span>, <span class="dt">bioc=</span><span class="ot">FALSE</span>, <span class="dt">level =</span> 2L, <span class="dt">user =</span> <span class="st">"ComputationalProteomicsUnit"</span>)</code></pre>
<div id="questions-and-support" class="section level2">
<h2 class="hasAnchor">
<html><body><a href="#questions-and-support" class="anchor"> </a></body></html>Questions and support</h2>
<p>To get help: - Open a GitHub <a href="https://github.com/ComputationalProteomicsUnit/cputools/issues">issue</a></p>
<blockquote>
<p>Add a <em>Questions and support</em> section.</p>
</blockquote>
<p>Note that this section can be added to the <code>README.Rmd</code> file and in the package vignette.</p>
<p>Asking a question is not a straightforward thing. Here are some resources to guide users:</p>
<ul>
<li>Think carefully where to ask you question, where you’ll reach the people most qualified to answer it: <a href="https://support.bioconductor.org/">Bioconductor support</a> forum, <a href="https://stackoverflow.com/">Stackoverflow</a>, <a href="https://stackoverflow.com/questions/tagged/r">Stackoverflow with <code>r</code> tag</a>, Bioc-devel mailing list, specific Github repositories, …</li>
<li>Don’t cross-post.</li>
<li>Always provide your <code>sessionInfo()</code>
</li>
<li>Jenny Bryans’s <a href="https://github.com/jennybc/reprex"><code>reprex</code></a> package.</li>
<li><a href="http://adv-r.had.co.nz/Reproducibility.html">How to write a reproducible example</a></li>
</ul>
<p>To update or discuss this, please use this issue<a href="#fn1" class="footnoteRef" id="fnref1"><sup>1</sup></a> or send directly a pull request.</p>
</div>
</div>
<div id="testing-coverage" class="section level1">
<h1 class="hasAnchor">
<html><body><a href="#testing-coverage" class="anchor"> </a></body></html>Testing coverage</h1>
</div>
<div id="package-webpage" class="section level1">
<h1 class="hasAnchor">
<html><body><a href="#package-webpage" class="anchor"> </a></body></html>Package webpage</h1>
</div>
<div id="session-information" class="section level1">
<h1 class="hasAnchor">
<html><body><a href="#session-information" class="anchor"> </a></body></html>Session information</h1>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">sessionInfo</span>()</code></pre>
<pre><code>## R Under development (unstable) (2016-12-09 r71771)
## Platform: x86_64-pc-linux-gnu (64-bit)
## Running under: Ubuntu 14.04.5 LTS
## 
## locale:
##  [1] LC_CTYPE=en_GB.UTF-8       LC_NUMERIC=C              
##  [3] LC_TIME=en_GB.UTF-8        LC_COLLATE=en_GB.UTF-8    
##  [5] LC_MONETARY=en_GB.UTF-8    LC_MESSAGES=en_GB.UTF-8   
##  [7] LC_PAPER=en_GB.UTF-8       LC_NAME=C                 
##  [9] LC_ADDRESS=C               LC_TELEPHONE=C            
## [11] LC_MEASUREMENT=en_GB.UTF-8 LC_IDENTIFICATION=C       
## 
## attached base packages:
## [1] stats     graphics  grDevices utils     datasets  methods   base     
## 
## other attached packages:
## [1] BiocStyle_2.3.28   cputools_0.2.0     pkgdown_0.1.0.9000
## 
## loaded via a namespace (and not attached):
##  [1] Rcpp_0.12.8.3        xml2_1.0.0.9002      knitr_1.15.1        
##  [4] whisker_0.3-2        magrittr_1.5         roxygen2_5.0.1      
##  [7] devtools_1.12.0.9000 munsell_0.4.3        pkgload_0.0.0.9000  
## [10] colorspace_1.3-2     R6_2.2.0             msdata_0.15.0       
## [13] plyr_1.8.4           stringr_1.1.0        tools_3.4.0         
## [16] pkgbuild_0.0.0.9000  withr_1.0.2          htmltools_0.3.5     
## [19] yaml_2.1.14          lazyeval_0.2.0       assertthat_0.1      
## [22] digest_0.6.11        rprojroot_1.1        tibble_1.2          
## [25] crayon_1.3.2         purrr_0.2.2          testthat_1.0.2.9000 
## [28] memoise_1.0.0        evaluate_0.10        rmarkdown_1.3       
## [31] stringi_1.1.2        compiler_3.4.0       desc_1.0.1          
## [34] scales_0.4.1         backports_1.0.4      highlight_0.4.7</code></pre>
</div>
<div class="footnotes">
<hr>
<ol>
<li id="fn1"><p><a href="https://github.com/ComputationalProteomicsUnit/cputools/issues/3">https://github.com/ComputationalProteomicsUnit/cputools/issues/3</a><a href="#fnref1">↩</a></p></li>
</ol>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li>
<a href="#introduction">Introduction</a><ul class="nav nav-pills nav-stacked">
<li><a href="#github-user">GitHub user</a></li>
      </ul>
</li>
      <li><a href="#credibility">Credibility</a></li>
      <li><a href="#description">DESCRIPTION</a></li>
      <li><a href="#readme-files">README files</a></li>
      <li><a href="#code-versioning-dissemination-and-issues">Code versioning, dissemination and issues</a></li>
      <li><a href="#continous-integration">Continous integration</a></li>
      <li>
<a href="#adding-status">Adding status</a><ul class="nav nav-pills nav-stacked">
<li><a href="#bioconductor-shields">Bioconductor shields</a></li>
      <li><a href="#travis-shield">Travis shield</a></li>
      <li><a href="#bioc-andor-travis">Bioc and/or travis</a></li>
      </ul>
</li>
      <li>
<a href="#asking-for-help">Asking for help</a><ul class="nav nav-pills nav-stacked">
<li><a href="#questions-and-support">Questions and support</a></li>
      </ul>
</li>
      <li><a href="#testing-coverage">Testing coverage</a></li>
      <li><a href="#package-webpage">Package webpage</a></li>
      <li><a href="#session-information">Session information</a></li>
      </ul>
</div>
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by Laurent Gatto.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://hadley.github.io/pkgdown/">pkgdown</a>.</p>
</div>

      </footer>
</div>

  </body>
</html>
